### **Selecionar Plano de Assinatura**

Objetivo: Permitir que escritório admin possa assinar ou alterar um plano de assinatura na plataforma seguindo todo o processo de seleção e checkout pré definido.

Critérios de Aceite: 

* Visualizar planos disponíveis com diferenciação visual de qual está ativo;  
* Possibilitar a seleção de um novo plano;  
* Preencher dados cadastrais (caso não tenha se cadastrado ainda)  
* Escolher forma de pagamento para período pago (após criação de loginl)  
  * Ex.: Cartão de crédito:  
    * Preencher com número do cartão \+ data de validade \+ CVV \+ Nome do titular no cartão;  
    * Selecionar quantidade de parcelas (se disponível);  
    * Preencher CPF/CNPJ;  
    * Preencher endereço de cobrança;  
    * Realizar pagamento;  
  * Ex.: Pix/boleto  
    * Gerar arquivo de Boleto/Qr Code para pagamento;  
* Processar pagamento:  
  * Tela de checkout exibindo se o pedido está em análise, concluído, etc;  
* Criar acesso automaticamente (caso cliente não esteja cadastrado previamente)  
  * Após a etapa de pagamento, liberar acesso à plataforma, mantendo cliente já logado;  
  * Enviar e-mail de confirmação de criação da conta;  
* Enviar e-mail sobre status da compra:  
  * Ao realizar a compra, enviar e-mail avisando que pedido foi recebido e está em análise;  
  * Ao constatar pagamento, enviar e-mail avisando que pedido teve seu pagamento realizado;

Cenários de Upgrade/Downgrase:  
Upgrade:

* Ao solicitar um Upgrade o escritório terá acesso imediato às novas condições do plano novo (aumento da quantidade de usuários, processos e demais itens a mais existentes no novo plano)  
* O valor financeiro a ser cobrado do cliente será o padrão já seguido em regras gerais de SaaS com cobrança prorata onde: O cliente pagará o valor proporcional para o restante do ciclo de cobrança e iniciará um novo ciclo para o próximo plano, ou seja:  
  * Valor do plano atual: R$ 100/mês  
  * Valor do novo plano: R$ 200/mês  
  * Dias restantes no ciclo: 15 dias  
  * Diferença diária entre os planos:  
    * R$ 200 \- R$ 100 \= R$ 100 de diferença por mês  
    * R$ 100 / 30 dias \= R$ 3,33 por dia  
  * Valor proporcional a ser cobrado pelo upgrade:  
    * 15 dias x R$ 3,33 \= R$ 49,95

DownGrade:

* O downgrade será agendado para o final do ciclo de cobrança vigente, após o pagamento pendente existente;  
* A partir do pagamento da fatura em aberto o plano ficará com as disposições do novo plano;

Campos:

| Campo | Descrição |
| :---- | :---- |
| ID Assinatura\* | Código gerado automaticamente |
| Plano Selecionado\* | Opções (Free, Standard, Premium, Enterprise) |
| Nome do Escritório | Campo obrigatório que deverá conter o nome do escritório contratante |
| Nome do contratante | Campo obrigatório onde deverá conter nome da pessoa representante que adquiriu o plano e, por isso, tem perfil de Admin do seu plano |
| E-mail do contratante | Campo obrigatório. E-mail da pessoa que adquiriu o plano e, por isso, tem perfil de Admin do seu plano; |
| CNPJ | Campo obrigatório. |
| Telefone | Campo Obrigatório com número de contato de quem adquiriu o plano. O telefone deverá ter o padrão de DDI+DDD+NÚMERO |
| Senha | Mínimo 6 caracteres (letras, números, especiais) |
| Validade Cartão | MM/AA (se cartão) |
| CVV | Números (se cartão) |
| Nome Titular | Texto livre (se cartão) |
| Parcelas | Opções (1x a 12x \- se cartão) |
| CPF/CNPJ\* | Números com validação |
| Endereço\* | Campo livre de texto |
| Status Pagamento\* | Opções (Em análise, Aprovado, Recusado) |

Cenários de uso:

| ID | Teste | Entrada | Saída Esperada |
| :---- | :---- | :---- | :---- |
| 1 | Selecionar plano free | Escolher plano gratuito | Acesso liberado após cadastro |
| 2 | Selecionar plano pago | Escolher plano standard/premium | Direcionamento para pagamento |
| 3 | Cadastro completo | Preencher dados cadastrais | Dados salvos com sucesso |
| 4 | Pagamento cartão | Inserir dados válidos | Pagamento aprovado |
| 5 | Cartão inválido | Inserir cartão incorreto | Mensagem de erro |
| 6 | Gerar boleto | Selecionar boleto | Boleto gerado com sucesso |
| 7 | Gerar PIX | Selecionar PIX | QR Code gerado com sucesso |
| 8 | Validar e-mail | E-mail inválido | Mensagem de erro |
| 9 | Validar CPF/CNPJ | Documento inválido | Mensagem de erro |
| 10 | E-mail confirmação | Pagamento aprovado | E-mail enviado com sucesso |
| 11 | E-mail análise | Pedido em análise | E-mail enviado com sucesso |
| 12 | Liberar acesso | Pagamento confirmado | Acesso liberado automaticamente |
| 13 | Plano enterprise | Solicitar contato | Direcionado para consultor |
| 14 | Campos obrigatórios | Deixar campo em branco | Mensagem de campo requerido |
| 15 | Manter logado | Finalizar processo | Usuário mantido na sessão |

